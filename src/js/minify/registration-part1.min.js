$(function(){let e=[],i=0,n=0,t=0,o="",a={user:{name:"123 Studio",game:!0,game_left:1,profile:!0},token:"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImFkYzMxNmFiNzNhZmZlMWM1OTZiZWQ2MGMxMjU0ODZmOGFkOWM3ODg5ZGJkMzA3NjM2OGIxZjVhZmY2YjBjNjUyMzA1YjA4YmM1ZGY2YTM1In0.eyJhdWQiOiIxIiwianRpIjoiYWRjMzE2YWI3M2FmZmUxYzU5NmJlZDYwYzEyNTQ4NmY4YWQ5Yzc4ODlkYmQzMDc2MzY4YjFmNWFmZjZiMGM2NTIzMDViMDhiYzVkZjZhMzUiLCJpYXQiOjE1NDU0Nzc2MjYsIm5iZiI6MTU0NTQ3NzYyNiwiZXhwIjoxNTc3MDEzNjI2LCJzdWIiOiIyNiIsInNjb3BlcyI6W119.SHJ-gn-JqKYKKT3YntpWV_CyilU5Jy2K0CR13245AORIFbz21wz84I6arpDX_qDfOqGuoSthxJfoIPh_Xc-eMq7TsTtzQ871U4c0WgxrNLZfL_bZfdgD5zh_700mzSqbts-o7CWvNqm4vq3HiyqYSexGvkMEDlCZradAmo2jf9DZ6MDSyvyMZ0hF4ISJm5Gan0RiUFJx_TK4BslUgLCM8J7dbhwl6WKpiGQCtIio4qj_AbHxuwYwQP7MRilbS9cSG-qPG2oz8mK50yPInxvuD3yEUFrSPkb4lq8PrsRaRGbVtSp1qk9fLCoAoJWPugzKcLhyxIomI8Wy_nxiu6ETdeXhYmT07SYdNArL6QeinESJA1GM6QOQiCyecuvKrZBVskj0hSWrP1mrCIcEq4m2qnxy-9yRAsZ5k4IpBREyj_9lIR4PZs0MNZV9Qtum37tsGWPtQjs_LQZGYcyy8PSYB5J0gSmpawgj9O4w1VQZPHNdfvyT0kHN2PJQmY53XGVo9LeKNEAZON2VG25RClHocdzPOHABm8Hl75o7-LIEkk5aTy76tRdzza5XwsHjqyb75Xs6q_SL_BNg8Ag9gKekmL3607D7BJqZ9AmffMKeuPWr3OcwqHSxCUrg5SmfRTnl_kI2wsSfsPXq8YIAWV1iYR76IIHdCvEghANjBpDSzHo"},l={user:{name:"123 Studio"},game_left:1,profile:!0,token:"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImFkYzMxNmFiNzNhZmZlMWM1OTZiZWQ2MGMxMjU0ODZmOGFkOWM3ODg5ZGJkMzA3NjM2OGIxZjVhZmY2YjBjNjUyMzA1YjA4YmM1ZGY2YTM1In0.eyJhdWQiOiIxIiwianRpIjoiYWRjMzE2YWI3M2FmZmUxYzU5NmJlZDYwYzEyNTQ4NmY4YWQ5Yzc4ODlkYmQzMDc2MzY4YjFmNWFmZjZiMGM2NTIzMDViMDhiYzVkZjZhMzUiLCJpYXQiOjE1NDU0Nzc2MjYsIm5iZiI6MTU0NTQ3NzYyNiwiZXhwIjoxNTc3MDEzNjI2LCJzdWIiOiIyNiIsInNjb3BlcyI6W119.SHJ-gn-JqKYKKT3YntpWV_CyilU5Jy2K0CR13245AORIFbz21wz84I6arpDX_qDfOqGuoSthxJfoIPh_Xc-eMq7TsTtzQ871U4c0WgxrNLZfL_bZfdgD5zh_700mzSqbts-o7CWvNqm4vq3HiyqYSexGvkMEDlCZradAmo2jf9DZ6MDSyvyMZ0hF4ISJm5Gan0RiUFJx_TK4BslUgLCM8J7dbhwl6WKpiGQCtIio4qj_AbHxuwYwQP7MRilbS9cSG-qPG2oz8mK50yPInxvuD3yEUFrSPkb4lq8PrsRaRGbVtSp1qk9fLCoAoJWPugzKcLhyxIomI8Wy_nxiu6ETdeXhYmT07SYdNArL6QeinESJA1GM6QOQiCyecuvKrZBVskj0hSWrP1mrCIcEq4m2qnxy-9yRAsZ5k4IpBREyj_9lIR4PZs0MNZV9Qtum37tsGWPtQjs_LQZGYcyy8PSYB5J0gSmpawgj9O4w1VQZPHNdfvyT0kHN2PJQmY53XGVo9LeKNEAZON2VG25RClHocdzPOHABm8Hl75o7-LIEkk5aTy76tRdzza5XwsHjqyb75Xs6q_SL_BNg8Ag9gKekmL3607D7BJqZ9AmffMKeuPWr3OcwqHSxCUrg5SmfRTnl_kI2wsSfsPXq8YIAWV1iYR76IIHdCvEghANjBpDSzHo"},s=$(".tab__button"),c=$(".registration__holder"),r=$("#register-error"),m=$("#register-button"),g=$("#login-error"),d=$("#login-button"),u=$("#logout-button"),h="register",w="login",f=0,I=["type","gender","name","birthday","phone","refcode"],p={name:"fullname",phone:"phone"},y={type:"Vui lòng chọn vị trí công việc của bạn!",name:"Vui lòng nhập họ và tên",gender:"Vui lòng chọn giới tính của bạn",birthday:"Vui lòng chọn ngày tháng năm sinh",phone:"Vui lòng nhập đúng số điện thoại của bạn"},S={type:null,name:null,gender:null,birthday:null,phone:null,refcode:null},M=$("#menu-login"),v=$("#reminder-login"),N=$("#menu-register"),Y=$("#registration-profile"),k=$("#quiz-section"),z=$("#congrate-holder"),Z=function(){Y.css({position:"absolute",top:"-100%",left:"-100%",opacity:0,visibility:"hidden"}),k.css({position:"absolute",top:0,left:0,opacity:0,visibility:"hidden"})},j=function(){s.each(function(e){$(this).on("click",K)}),b(),T(),m.on("click",x),d.on("click",V),u.on("click",W)},b=function(){M.on("click",O),v.on("click",O),N.on("click",()=>{const e=$("#tab-login"),i=$("#tab-register"),n=i.attr("itemid");i.addClass("active"),e.removeClass("active"),H(n)})},O=function(e){const i=$("#tab-login"),n=$("#tab-register"),t=i.attr("itemid");i.addClass("active"),n.removeClass("active"),H(t)},T=function(){$("#chu-nha-thuoc").on("click",()=>{S.type=1}),$("#nhan-vien").on("click",()=>{S.type=0}),$("#male").on("click",()=>{S.gender=1}),$("#female").on("click",()=>{S.gender=0})},C=function(e,i){switch(e){case h:TweenMax.killTweensOf(r),TweenMax.to(r,.3,{alpha:1,ease:Sine.easeOut}),r.html(i);break;case w:TweenMax.killTweensOf(g),TweenMax.to(g,.3,{alpha:1,ease:Sine.easeOut}),g.html(i)}clearTimeout(f),f=setTimeout(J,5e3,e)},J=function(e){switch(e){case h:TweenMax.killTweensOf(r),TweenMax.to(r,.3,{alpha:0,ease:Sine.easeOut});break;case w:TweenMax.killTweensOf(g),TweenMax.to(g,.3,{alpha:0,ease:Sine.easeOut})}},x=function(){if(R(),U())if(isLocal)D(l);else{const e=baseUrl+"register";$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify(S),url:e,success:D,error:E})}},D=function(e){e.token&&(window.localStorage.setItem("token",e.token),window.localStorage.setItem("username",e.user.name),window.localStorage.setItem("game",!1),window.localStorage.setItem("gameLeft",e.game_left),window.localStorage.setItem("profile",e.profile),G())},q=function(e){e.token&&(window.localStorage.setItem("token",e.token),window.localStorage.setItem("username",e.user.name),window.localStorage.setItem("game",e.user.game),window.localStorage.setItem("gameLeft",e.user.game_left),window.localStorage.setItem("profile",e.user.profile),G()),"Login Failed"===e.message&&C(w,"Không thể nhập, vui lòng kiểm tra lại số điện thoại")},W=function(){window.localStorage.removeItem("token"),window.localStorage.removeItem("username"),window.localStorage.removeItem("game"),window.localStorage.removeItem("gameLeft"),window.localStorage.removeItem("profile"),location.reload(),L()},G=function(){$(".registration__nav").each(function(e){$(this).addClass("deactive")}),$("#registration-section").addClass("deactive"),$(".logout").addClass("logged"),$(".game").addClass("active"),$("#username").html(window.localStorage.getItem("username")+", "),$("#quiz-welcome-name").html(window.localStorage.getItem("username"));window.localStorage.getItem("game");const e=Number(window.localStorage.getItem("gameLeft")),i="true"===window.localStorage.getItem("profile");e>0?(Q(),window.dispatchEvent(StartGameEvent)):i?A():_()},Q=function(){k.css({position:"relative",opacity:1,visibility:"visible"})},_=function(){Y.css({display:"block",position:"relative",left:0,top:0,opacity:1,visibility:"visible"})},A=function(){Y.css({display:"none"}),z.css({display:"block"})},L=function(){$(".registration__nav").each(function(e){$(this).removeClass("deactive")}),$(".logout").removeClass("logged"),$(".game").removeClass("active"),$("#registration-section").removeClass("deactive")},P=function(e){const i=e.responseJSON;if(i.errors&&Object.values(i.errors)[0][0]){Object.values(i.errors)[0][0];C(w,"Sai thông tin đăng nhập, vui lòng kiểm tra lại số điện thoại")}else C(w,"Không thể nhập, vui lòng kiểm tra lại số điện thoại")},E=function(e){e.responseJSON;C(h,"Thông tin đã có trong hệ thống, vui lòng Đăng Nhập.")},R=function(){S.birthday=o,Object.keys(p).forEach(e=>{const i=$("#"+p[e]).val();S[e]=i})},U=function(){for(let e=0;e<I.length;e++){const i=I[e];if((null===S[i]||void 0===S[i]||""===S[i])&&"refcode"!=i){return C(h,y[i]),!1}}return!0},V=function(){const e=$("#login-phone").val(),i=$("#login-refcode").val(),n={phone:e,refcode:null};if(e.length>0)if(isLocal)i.length>0&&(n.refcode=i),console.log(n),q(a);else{i.length>0&&(n.refcode=i,console.log(n));const e=baseUrl+"login";$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify(n),url:e,success:q,error:P})}else C(w,"Vui lòng nhập số điện để đăng nhập!")},K=function(e){const i=$(e.currentTarget).attr("itemID");s.each(function(e){const n=$(this);n.attr("itemID")==i?n.addClass("active"):n.removeClass("active")}),H(i)},H=function(e){c.each(function(){const i=$(this);i.attr("itemID")==e?i.addClass("active"):i.removeClass("active")})},B=function(){window.localStorage.token&&G()},F=function(e){i=e>9?e:"0"+e,0!=n&&0!=t&&(o=t+"-"+n+"-"+i)},X=function(e){n=e>9?e:"0"+e,0!=i&&0!=t&&(o=t+"-"+n+"-"+i)},ee=function(e){t=e,0!=i&&0!=n&&(o=t+"-"+n+"-"+i)},ie=function(){window.dropdownMap&&window.dropdownMap.size>0&&window.dropdownMap.forEach(e=>e.collapse())};!function(){for(let i=2e3;i>1900;i--)e.push(i);let i={itemArray:[1,2,3,4,5,6,7,8,9,10,11,12],itemHeight:40},n={itemArray:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],itemHeight:40};new DropDownBox("dropdown-year",{itemArray:e,itemHeight:40},"Năm",ee),new DropDownBox("dropdown-month",i,"Tháng",X),new DropDownBox("dropdown-day",n,"Ngày",F);window.addEventListener("click",ie),j(),Z(),setTimeout(B,0)}()});