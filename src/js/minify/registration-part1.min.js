$(function(){let e=[],t=0,i=0,n=0,o="",a={user:{name:"123 Studio",game:!0,game_left:0,profile:!0},token:"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImFkYzMxNmFiNzNhZmZlMWM1OTZiZWQ2MGMxMjU0ODZmOGFkOWM3ODg5ZGJkMzA3NjM2OGIxZjVhZmY2YjBjNjUyMzA1YjA4YmM1ZGY2YTM1In0.eyJhdWQiOiIxIiwianRpIjoiYWRjMzE2YWI3M2FmZmUxYzU5NmJlZDYwYzEyNTQ4NmY4YWQ5Yzc4ODlkYmQzMDc2MzY4YjFmNWFmZjZiMGM2NTIzMDViMDhiYzVkZjZhMzUiLCJpYXQiOjE1NDU0Nzc2MjYsIm5iZiI6MTU0NTQ3NzYyNiwiZXhwIjoxNTc3MDEzNjI2LCJzdWIiOiIyNiIsInNjb3BlcyI6W119.SHJ-gn-JqKYKKT3YntpWV_CyilU5Jy2K0CR13245AORIFbz21wz84I6arpDX_qDfOqGuoSthxJfoIPh_Xc-eMq7TsTtzQ871U4c0WgxrNLZfL_bZfdgD5zh_700mzSqbts-o7CWvNqm4vq3HiyqYSexGvkMEDlCZradAmo2jf9DZ6MDSyvyMZ0hF4ISJm5Gan0RiUFJx_TK4BslUgLCM8J7dbhwl6WKpiGQCtIio4qj_AbHxuwYwQP7MRilbS9cSG-qPG2oz8mK50yPInxvuD3yEUFrSPkb4lq8PrsRaRGbVtSp1qk9fLCoAoJWPugzKcLhyxIomI8Wy_nxiu6ETdeXhYmT07SYdNArL6QeinESJA1GM6QOQiCyecuvKrZBVskj0hSWrP1mrCIcEq4m2qnxy-9yRAsZ5k4IpBREyj_9lIR4PZs0MNZV9Qtum37tsGWPtQjs_LQZGYcyy8PSYB5J0gSmpawgj9O4w1VQZPHNdfvyT0kHN2PJQmY53XGVo9LeKNEAZON2VG25RClHocdzPOHABm8Hl75o7-LIEkk5aTy76tRdzza5XwsHjqyb75Xs6q_SL_BNg8Ag9gKekmL3607D7BJqZ9AmffMKeuPWr3OcwqHSxCUrg5SmfRTnl_kI2wsSfsPXq8YIAWV1iYR76IIHdCvEghANjBpDSzHo"},l={user:{name:"123 Studio"},game_left:0,profile:!0,token:"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImFkYzMxNmFiNzNhZmZlMWM1OTZiZWQ2MGMxMjU0ODZmOGFkOWM3ODg5ZGJkMzA3NjM2OGIxZjVhZmY2YjBjNjUyMzA1YjA4YmM1ZGY2YTM1In0.eyJhdWQiOiIxIiwianRpIjoiYWRjMzE2YWI3M2FmZmUxYzU5NmJlZDYwYzEyNTQ4NmY4YWQ5Yzc4ODlkYmQzMDc2MzY4YjFmNWFmZjZiMGM2NTIzMDViMDhiYzVkZjZhMzUiLCJpYXQiOjE1NDU0Nzc2MjYsIm5iZiI6MTU0NTQ3NzYyNiwiZXhwIjoxNTc3MDEzNjI2LCJzdWIiOiIyNiIsInNjb3BlcyI6W119.SHJ-gn-JqKYKKT3YntpWV_CyilU5Jy2K0CR13245AORIFbz21wz84I6arpDX_qDfOqGuoSthxJfoIPh_Xc-eMq7TsTtzQ871U4c0WgxrNLZfL_bZfdgD5zh_700mzSqbts-o7CWvNqm4vq3HiyqYSexGvkMEDlCZradAmo2jf9DZ6MDSyvyMZ0hF4ISJm5Gan0RiUFJx_TK4BslUgLCM8J7dbhwl6WKpiGQCtIio4qj_AbHxuwYwQP7MRilbS9cSG-qPG2oz8mK50yPInxvuD3yEUFrSPkb4lq8PrsRaRGbVtSp1qk9fLCoAoJWPugzKcLhyxIomI8Wy_nxiu6ETdeXhYmT07SYdNArL6QeinESJA1GM6QOQiCyecuvKrZBVskj0hSWrP1mrCIcEq4m2qnxy-9yRAsZ5k4IpBREyj_9lIR4PZs0MNZV9Qtum37tsGWPtQjs_LQZGYcyy8PSYB5J0gSmpawgj9O4w1VQZPHNdfvyT0kHN2PJQmY53XGVo9LeKNEAZON2VG25RClHocdzPOHABm8Hl75o7-LIEkk5aTy76tRdzza5XwsHjqyb75Xs6q_SL_BNg8Ag9gKekmL3607D7BJqZ9AmffMKeuPWr3OcwqHSxCUrg5SmfRTnl_kI2wsSfsPXq8YIAWV1iYR76IIHdCvEghANjBpDSzHo"},r=$(".tab__button"),s=$(".registration__holder"),c=$("#register-error"),m=$("#register-button"),g=$("#login-error"),u=$("#login-button"),d=$("#logout-button"),h="register",f="login",w=0,p=["type","gender","name","birthday","phone","ref_code"],I={name:"fullname",phone:"phone",ref_code:"ref_code"},y={type:"Vui lòng chọn vị trí công việc của bạn!",name:"Vui lòng nhập họ và tên",gender:"Vui lòng chọn giới tính của bạn",birthday:"Vui lòng chọn ngày tháng năm sinh",phone:"Vui lòng nhập đúng số điện thoại của bạn"},S={type:null,name:null,gender:null,birthday:null,phone:null,ref_code:null},M=$("#menu-login"),v=$("#reminder-login"),N=$("#menu-register"),k=$("#registration-profile"),Y=$("#quiz-section"),b=$("#congrate-holder"),z=$("#congrate-title"),Z=$("#congrate-message"),j=function(){k.css({position:"absolute",top:"-100%",left:"-100%",opacity:0,visibility:"hidden"}),Y.css({position:"absolute",top:0,left:0,opacity:0,visibility:"hidden"})},O=function(){r.each(function(e){$(this).on("click",B)}),T(),J(),m.on("click",D),u.on("click",H),d.on("click",G)},T=function(){M.on("click",x),v.on("click",x),N.on("click",()=>{const e=$("#tab-login"),t=$("#tab-register"),i=t.attr("itemid");t.addClass("active"),e.removeClass("active"),F(i)})},x=function(e){const t=$("#tab-login"),i=$("#tab-register"),n=t.attr("itemid");t.addClass("active"),i.removeClass("active"),F(n)},J=function(){$("#chu-nha-thuoc").on("click",()=>{S.type=1}),$("#nhan-vien").on("click",()=>{S.type=0}),$("#male").on("click",()=>{S.gender=1}),$("#female").on("click",()=>{S.gender=0})},_=function(e,t){switch(e){case h:TweenMax.killTweensOf(c),TweenMax.to(c,.3,{alpha:1,ease:Sine.easeOut}),c.html(t);break;case f:TweenMax.killTweensOf(g),TweenMax.to(g,.3,{alpha:1,ease:Sine.easeOut}),g.html(t)}clearTimeout(w),w=setTimeout(C,5e3,e)},C=function(e){switch(e){case h:TweenMax.killTweensOf(c),TweenMax.to(c,.3,{alpha:0,ease:Sine.easeOut});break;case f:TweenMax.killTweensOf(g),TweenMax.to(g,.3,{alpha:0,ease:Sine.easeOut})}},D=function(){if(R(),K())if(isLocal)q(l);else{const e=baseUrl+"register";$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify(S),url:e,success:q,error:U})}},q=function(e){e.token&&(window.localStorage.setItem("token",e.token),window.localStorage.setItem("username",e.user.name),window.localStorage.setItem("game",!1),window.localStorage.setItem("gameLeft",e.game_left),window.localStorage.setItem("profile",e.profile),Q())},W=function(e){e.token&&(window.localStorage.setItem("token",e.token),window.localStorage.setItem("username",e.user.name),window.localStorage.setItem("game",e.user.game),window.localStorage.setItem("gameLeft",e.user.game_left),window.localStorage.setItem("profile",e.user.profile),Q()),"Login Failed"===e.message&&_(f,"Không thể nhập, vui lòng kiểm tra lại số điện thoại")},G=function(){window.localStorage.removeItem("token"),window.localStorage.removeItem("username"),window.localStorage.removeItem("game"),window.localStorage.removeItem("gameLeft"),window.localStorage.removeItem("profile"),location.reload(),V()},Q=function(){$(".registration__nav").each(function(e){$(this).addClass("deactive")}),$("#registration-section").addClass("deactive"),$(".logout").addClass("logged"),$(".game").addClass("active"),$("#username").html(window.localStorage.getItem("username")+", "),$("#quiz-welcome-name").html(window.localStorage.getItem("username"));window.localStorage.getItem("game");const e=Number(window.localStorage.getItem("gameLeft")),t="true"===window.localStorage.getItem("profile");e>0?(A(),window.dispatchEvent(StartGameEvent)):t?P(e):L()},A=function(){Y.css({position:"relative",opacity:1,visibility:"visible"})},L=function(){var e=$("#registration-profile").position()-100;window.scrollTo({top:e.top-100,behavior:"smooth"}),k.css({display:"block",position:"relative",left:0,top:0,opacity:1,visibility:"visible"})},P=function(e){0==e&&($("#congrate-button-text").text("OK"),z.text("Bạn đã hết lượt chơi."),Z.text("Hẹn gặp bạn ở chương trình sau!"),$("#congrate-button-text").on("click",()=>{window.scrollTo(0,0)})),k.css({display:"none"}),b.css({display:"block"})},V=function(){$(".registration__nav").each(function(e){$(this).removeClass("deactive")}),$(".logout").removeClass("logged"),$(".game").removeClass("active"),$("#registration-section").removeClass("deactive")},E=function(e){const t=e.responseJSON;if(t.errors&&Object.values(t.errors)[0][0]){Object.values(t.errors)[0][0];_(f,"Sai thông tin đăng nhập, vui lòng kiểm tra lại số điện thoại")}else _(f,"Không thể nhập, vui lòng kiểm tra lại số điện thoại")},U=function(e){e.responseJSON;_(h,"Thông tin đã có trong hệ thống, vui lòng Đăng Nhập.")},R=function(){S.birthday=o,Object.keys(I).forEach(e=>{const t=$("#"+I[e]).val();S[e]=t})},K=function(){for(let e=0;e<p.length;e++){const t=p[e];if(null===S[t]||void 0===S[t]||""===S[t]){if("ref_code"==t){const e=$("#ref_code").val();return!(e.length>0)||(7==e.length||(_(h,"Vui lòng kiểm tra lại mã người giới thiệu."),!1))}return _(h,y[t]),!1}}return!0},H=function(){const e=$("#login-phone").val(),t=$("#login-refcode").val(),i={phone:e,ref_code:null};if(e.length>0)if(isLocal)t.length>0?7==t.length?(i.ref_code=t,W(a)):_(f,"Vui lòng kiểm tra lại mã người giới thiệu."):W(a);else if(t.length>0)if(7==t.length){i.ref_code=t;const e=baseUrl+"login";$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify(i),url:e,success:W,error:E})}else _(f,"Vui lòng kiểm tra lại mã người giới thiệu.");else{const e=baseUrl+"login";$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify(i),url:e,success:W,error:E})}else _(f,"Vui lòng nhập số điện để đăng nhập!")},B=function(e){const t=$(e.currentTarget).attr("itemID");r.each(function(e){const i=$(this);i.attr("itemID")==t?i.addClass("active"):i.removeClass("active")}),F(t)},F=function(e){s.each(function(){const t=$(this);t.attr("itemID")==e?t.addClass("active"):t.removeClass("active")})},X=function(){window.localStorage.token&&Q()},ee=function(e){t=e>9?e:"0"+e,0!=i&&0!=n&&(o=n+"-"+i+"-"+t)},te=function(e){i=e>9?e:"0"+e,0!=t&&0!=n&&(o=n+"-"+i+"-"+t)},ie=function(e){n=e,0!=t&&0!=i&&(o=n+"-"+i+"-"+t)},ne=function(){window.dropdownMap&&window.dropdownMap.size>0&&window.dropdownMap.forEach(e=>e.collapse())};!function(){for(let t=2e3;t>1900;t--)e.push(t);let t={itemArray:[1,2,3,4,5,6,7,8,9,10,11,12],itemHeight:40},i={itemArray:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],itemHeight:40};new DropDownBox("dropdown-year",{itemArray:e,itemHeight:40},"Năm",ie),new DropDownBox("dropdown-month",t,"Tháng",te),new DropDownBox("dropdown-day",i,"Ngày",ee);window.addEventListener("click",ne),O(),j(),setTimeout(X,0)}()});