$(function(){let e=[],i=0,t=0,n=0,o="",a={user:{name:"123 Studio",game:!0,game_left:2,profile:!1},token:"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImFkYzMxNmFiNzNhZmZlMWM1OTZiZWQ2MGMxMjU0ODZmOGFkOWM3ODg5ZGJkMzA3NjM2OGIxZjVhZmY2YjBjNjUyMzA1YjA4YmM1ZGY2YTM1In0.eyJhdWQiOiIxIiwianRpIjoiYWRjMzE2YWI3M2FmZmUxYzU5NmJlZDYwYzEyNTQ4NmY4YWQ5Yzc4ODlkYmQzMDc2MzY4YjFmNWFmZjZiMGM2NTIzMDViMDhiYzVkZjZhMzUiLCJpYXQiOjE1NDU0Nzc2MjYsIm5iZiI6MTU0NTQ3NzYyNiwiZXhwIjoxNTc3MDEzNjI2LCJzdWIiOiIyNiIsInNjb3BlcyI6W119.SHJ-gn-JqKYKKT3YntpWV_CyilU5Jy2K0CR13245AORIFbz21wz84I6arpDX_qDfOqGuoSthxJfoIPh_Xc-eMq7TsTtzQ871U4c0WgxrNLZfL_bZfdgD5zh_700mzSqbts-o7CWvNqm4vq3HiyqYSexGvkMEDlCZradAmo2jf9DZ6MDSyvyMZ0hF4ISJm5Gan0RiUFJx_TK4BslUgLCM8J7dbhwl6WKpiGQCtIio4qj_AbHxuwYwQP7MRilbS9cSG-qPG2oz8mK50yPInxvuD3yEUFrSPkb4lq8PrsRaRGbVtSp1qk9fLCoAoJWPugzKcLhyxIomI8Wy_nxiu6ETdeXhYmT07SYdNArL6QeinESJA1GM6QOQiCyecuvKrZBVskj0hSWrP1mrCIcEq4m2qnxy-9yRAsZ5k4IpBREyj_9lIR4PZs0MNZV9Qtum37tsGWPtQjs_LQZGYcyy8PSYB5J0gSmpawgj9O4w1VQZPHNdfvyT0kHN2PJQmY53XGVo9LeKNEAZON2VG25RClHocdzPOHABm8Hl75o7-LIEkk5aTy76tRdzza5XwsHjqyb75Xs6q_SL_BNg8Ag9gKekmL3607D7BJqZ9AmffMKeuPWr3OcwqHSxCUrg5SmfRTnl_kI2wsSfsPXq8YIAWV1iYR76IIHdCvEghANjBpDSzHo"},l={user:{name:"123 Studio"},game_left:0,profile:!1,token:"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImFkYzMxNmFiNzNhZmZlMWM1OTZiZWQ2MGMxMjU0ODZmOGFkOWM3ODg5ZGJkMzA3NjM2OGIxZjVhZmY2YjBjNjUyMzA1YjA4YmM1ZGY2YTM1In0.eyJhdWQiOiIxIiwianRpIjoiYWRjMzE2YWI3M2FmZmUxYzU5NmJlZDYwYzEyNTQ4NmY4YWQ5Yzc4ODlkYmQzMDc2MzY4YjFmNWFmZjZiMGM2NTIzMDViMDhiYzVkZjZhMzUiLCJpYXQiOjE1NDU0Nzc2MjYsIm5iZiI6MTU0NTQ3NzYyNiwiZXhwIjoxNTc3MDEzNjI2LCJzdWIiOiIyNiIsInNjb3BlcyI6W119.SHJ-gn-JqKYKKT3YntpWV_CyilU5Jy2K0CR13245AORIFbz21wz84I6arpDX_qDfOqGuoSthxJfoIPh_Xc-eMq7TsTtzQ871U4c0WgxrNLZfL_bZfdgD5zh_700mzSqbts-o7CWvNqm4vq3HiyqYSexGvkMEDlCZradAmo2jf9DZ6MDSyvyMZ0hF4ISJm5Gan0RiUFJx_TK4BslUgLCM8J7dbhwl6WKpiGQCtIio4qj_AbHxuwYwQP7MRilbS9cSG-qPG2oz8mK50yPInxvuD3yEUFrSPkb4lq8PrsRaRGbVtSp1qk9fLCoAoJWPugzKcLhyxIomI8Wy_nxiu6ETdeXhYmT07SYdNArL6QeinESJA1GM6QOQiCyecuvKrZBVskj0hSWrP1mrCIcEq4m2qnxy-9yRAsZ5k4IpBREyj_9lIR4PZs0MNZV9Qtum37tsGWPtQjs_LQZGYcyy8PSYB5J0gSmpawgj9O4w1VQZPHNdfvyT0kHN2PJQmY53XGVo9LeKNEAZON2VG25RClHocdzPOHABm8Hl75o7-LIEkk5aTy76tRdzza5XwsHjqyb75Xs6q_SL_BNg8Ag9gKekmL3607D7BJqZ9AmffMKeuPWr3OcwqHSxCUrg5SmfRTnl_kI2wsSfsPXq8YIAWV1iYR76IIHdCvEghANjBpDSzHo"},s=$(".tab__button"),r=$(".registration__holder"),c=$("#register-error"),m=$("#register-button"),g=$("#login-error"),u=$("#login-button"),d=$("#logout-button"),h="register",f="login",w=0,I=["type","gender","name","birthday","phone","ref_code"],p={name:"fullname",phone:"phone",ref_code:"ref_code"},y={type:"Vui lòng chọn vị trí công việc của bạn!",name:"Vui lòng nhập họ và tên",gender:"Vui lòng chọn giới tính của bạn",birthday:"Vui lòng chọn ngày tháng năm sinh",phone:"Vui lòng nhập đúng số điện thoại của bạn"},S={type:null,name:null,gender:null,birthday:null,phone:null,ref_code:null},M=$("#menu-login"),v=$("#reminder-login"),N=$("#menu-register"),k=$("#registration-profile"),Y=$("#quiz-section"),z=$("#congrate-holder"),Z=function(){k.css({position:"absolute",top:"-100%",left:"-100%",opacity:0,visibility:"hidden"}),Y.css({position:"absolute",top:0,left:0,opacity:0,visibility:"hidden"})},j=function(){s.each(function(e){$(this).on("click",K)}),b(),T(),m.on("click",x),u.on("click",R),d.on("click",q)},b=function(){M.on("click",O),v.on("click",O),N.on("click",()=>{const e=$("#tab-login"),i=$("#tab-register"),t=i.attr("itemid");i.addClass("active"),e.removeClass("active"),H(t)})},O=function(e){const i=$("#tab-login"),t=$("#tab-register"),n=i.attr("itemid");i.addClass("active"),t.removeClass("active"),H(n)},T=function(){$("#chu-nha-thuoc").on("click",()=>{S.type=1}),$("#nhan-vien").on("click",()=>{S.type=0}),$("#male").on("click",()=>{S.gender=1}),$("#female").on("click",()=>{S.gender=0})},J=function(e,i){switch(e){case h:TweenMax.killTweensOf(c),TweenMax.to(c,.3,{alpha:1,ease:Sine.easeOut}),c.html(i);break;case f:TweenMax.killTweensOf(g),TweenMax.to(g,.3,{alpha:1,ease:Sine.easeOut}),g.html(i)}clearTimeout(w),w=setTimeout(_,5e3,e)},_=function(e){switch(e){case h:TweenMax.killTweensOf(c),TweenMax.to(c,.3,{alpha:0,ease:Sine.easeOut});break;case f:TweenMax.killTweensOf(g),TweenMax.to(g,.3,{alpha:0,ease:Sine.easeOut})}},x=function(){if(E(),U())if(isLocal)C(l);else{const e=baseUrl+"register";$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify(S),url:e,success:C,error:V})}},C=function(e){e.token&&(window.localStorage.setItem("token",e.token),window.localStorage.setItem("username",e.user.name),window.localStorage.setItem("game",!1),window.localStorage.setItem("gameLeft",e.game_left),window.localStorage.setItem("profile",e.profile),W())},D=function(e){e.token&&(window.localStorage.setItem("token",e.token),window.localStorage.setItem("username",e.user.name),window.localStorage.setItem("game",e.user.game),window.localStorage.setItem("gameLeft",e.user.game_left),window.localStorage.setItem("profile",e.user.profile),W()),"Login Failed"===e.message&&J(f,"Không thể nhập, vui lòng kiểm tra lại số điện thoại")},q=function(){window.localStorage.removeItem("token"),window.localStorage.removeItem("username"),window.localStorage.removeItem("game"),window.localStorage.removeItem("gameLeft"),window.localStorage.removeItem("profile"),location.reload(),L()},W=function(){$(".registration__nav").each(function(e){$(this).addClass("deactive")}),$("#registration-section").addClass("deactive"),$(".logout").addClass("logged"),$(".game").addClass("active"),$("#username").html(window.localStorage.getItem("username")+", "),$("#quiz-welcome-name").html(window.localStorage.getItem("username"));window.localStorage.getItem("game");const e=Number(window.localStorage.getItem("gameLeft")),i="true"===window.localStorage.getItem("profile");e>0?(G(),window.dispatchEvent(StartGameEvent)):i?A():Q()},G=function(){Y.css({position:"relative",opacity:1,visibility:"visible"})},Q=function(){k.css({display:"block",position:"relative",left:0,top:0,opacity:1,visibility:"visible"})},A=function(){k.css({display:"none"}),z.css({display:"block"})},L=function(){$(".registration__nav").each(function(e){$(this).removeClass("deactive")}),$(".logout").removeClass("logged"),$(".game").removeClass("active"),$("#registration-section").removeClass("deactive")},P=function(e){const i=e.responseJSON;if(i.errors&&Object.values(i.errors)[0][0]){Object.values(i.errors)[0][0];J(f,"Sai thông tin đăng nhập, vui lòng kiểm tra lại số điện thoại")}else J(f,"Không thể nhập, vui lòng kiểm tra lại số điện thoại")},V=function(e){e.responseJSON;J(h,"Thông tin đã có trong hệ thống, vui lòng Đăng Nhập.")},E=function(){S.birthday=o,Object.keys(p).forEach(e=>{const i=$("#"+p[e]).val();S[e]=i})},U=function(){for(let e=0;e<I.length;e++){const i=I[e];if(null===S[i]||void 0===S[i]||""===S[i]){if("ref_code"==i){const e=$("#ref_code").val();return!(e.length>0)||(7==e.length||(J(h,"Vui lòng kiểm tra lại mã người giới thiệu."),!1))}return J(h,y[i]),!1}}return!0},R=function(){const e=$("#login-phone").val(),i=$("#login-refcode").val(),t={phone:e,ref_code:null};if(e.length>0)if(isLocal)i.length>0?7==i.length?(t.ref_code=i,D(a)):J(f,"Vui lòng kiểm tra lại mã người giới thiệu."):D(a);else if(i.length>0)if(7==i.length){t.ref_code=i;const e=baseUrl+"login";$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify(t),url:e,success:D,error:P})}else J(f,"Vui lòng kiểm tra lại mã người giới thiệu.");else{const e=baseUrl+"login";$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify(t),url:e,success:D,error:P})}else J(f,"Vui lòng nhập số điện để đăng nhập!")},K=function(e){const i=$(e.currentTarget).attr("itemID");s.each(function(e){const t=$(this);t.attr("itemID")==i?t.addClass("active"):t.removeClass("active")}),H(i)},H=function(e){r.each(function(){const i=$(this);i.attr("itemID")==e?i.addClass("active"):i.removeClass("active")})},B=function(){window.localStorage.token&&W()},F=function(e){i=e>9?e:"0"+e,0!=t&&0!=n&&(o=n+"-"+t+"-"+i)},X=function(e){t=e>9?e:"0"+e,0!=i&&0!=n&&(o=n+"-"+t+"-"+i)},ee=function(e){n=e,0!=i&&0!=t&&(o=n+"-"+t+"-"+i)},ie=function(){window.dropdownMap&&window.dropdownMap.size>0&&window.dropdownMap.forEach(e=>e.collapse())};!function(){for(let i=2e3;i>1900;i--)e.push(i);let i={itemArray:[1,2,3,4,5,6,7,8,9,10,11,12],itemHeight:40},t={itemArray:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],itemHeight:40};new DropDownBox("dropdown-year",{itemArray:e,itemHeight:40},"Năm",ee),new DropDownBox("dropdown-month",i,"Tháng",X),new DropDownBox("dropdown-day",t,"Ngày",F);window.addEventListener("click",ie),j(),Z(),setTimeout(B,0)}()});