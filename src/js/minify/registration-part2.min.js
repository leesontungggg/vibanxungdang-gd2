$(function(){let n=[],e=[],i=[],a=0,o=0,t=[{id:25,name:"Q. Ba Đình"},{id:26,name:"Q. Cầu Giấy"},{id:27,name:"Q. Đống Đa"},{id:28,name:"Q. Hai Bà Trưng"},{id:29,name:"Q. Hoàn Kiếm"},{id:30,name:"Q. Long Biên"},{id:31,name:"Q. Tây Hồ"},{id:32,name:"Q. Thanh Xuân"},{id:33,name:"Q. Hoàng Mai"},{id:34,name:"H. Đông Anh"},{id:35,name:"H. Gia Lâm"},{id:36,name:"H. Sóc Sơn"},{id:37,name:"H. Thanh Trì"},{id:38,name:"H. Từ Liêm"},{id:629,name:"H. Chương Mỹ"},{id:630,name:"H. Đan Phượng"},{id:631,name:"Q. Hà Đông"},{id:632,name:"H. Hoài Đức"},{id:633,name:"H. Phú Xuyên"},{id:649,name:"H. Ba Vì"},{id:650,name:"T. Bắc Ninh"},{id:651,name:"T. Hà Tây"},{id:652,name:"T. Hưng Yên"},{id:653,name:"H. Mê Linh"},{id:654,name:"H. Mỹ Đức"},{id:655,name:"P. Nguyễn Tuân"},{id:656,name:"H. Quốc Oai"},{id:657,name:"TX. Sơn Tây"},{id:658,name:"X. Tân Triều"},{id:659,name:"H. Thạch Thất"},{id:660,name:"H. Văn Giang"},{id:663,name:"H. Thường Tín"},{id:675,name:"TT. Xuân Mai"},{id:676,name:"TT. Phú Minh"},{id:677,name:"H. Đông Ba"},{id:678,name:"Q. Hòa Bình"}],c={message:"Update success"},s=$("#registration-profile"),d=$("#profile-error"),m=$("#profile-button"),r="profile",l="login",h=0,u=["passport","username_facebook","email","province_id","district_id","address","company_name"],g={passport:"passport",username_facebook:"nick-facebook",email:"email",address:"work-address",company_name:"store-address"},p=$("#agreement-checkbox"),T={email:"Vui lòng nhập email của bạn",passport:"Vui lòng nhập số CMND để nhận giải thưởng",username_facebook:"Vui lòng nhập nick facebook của bạn để tham gia",province_id:"Bạn chưa chọn địa chỉ đang công tác",district_id:"Bạn chưa chọn địa chỉ đang công tác",address:"Bạn chưa nhập đầy đủ địa chỉ đang công tác",company_name:"Bạn chưa nhập đầy đủ địa chỉ đang công tác"},f={email:null,passport:null,username_facebook:null,province_id:null,district_id:null,address:null,company_name:null},w=$("#tnc-link"),H=$("#security-link"),y=$("#profile-guide"),k=$("#guide-button"),B=$("#profile-content"),b=$("#congrate-holder"),v=$("#congrate-button"),N=$("#congrate-title"),M=$("#congrate-message"),x=$("#quiz-section"),S=$("#quiz-result-feedback"),_=function(){L(),m.on("click",C),isLocal?(n=[{id:4,name:"Hà Nội"},{id:8,name:"TP. Hồ Chí Minh"},{id:76,name:"An Giang"},{id:64,name:"Bà Rịa Vũng Tàu"},{id:781,name:"Bắc Cạn"},{id:281,name:"Bắc Giang"},{id:240,name:"Bạc Liêu"},{id:241,name:"Bắc Ninh"},{id:75,name:"Bến Tre"},{id:650,name:"Bình Định"},{id:56,name:"Bình Dương"},{id:651,name:"Bình Phước"},{id:62,name:"Bình Thuận"},{id:780,name:"Cà Mau"},{id:710,name:"Cần Thơ"},{id:26,name:"Cao Bằng"},{id:511,name:"Đà Nẵng"},{id:500,name:"Đăk Lăk"},{id:501,name:"Đăk Nông"},{id:230,name:"Điện Biên"},{id:61,name:"Đồng Nai"},{id:67,name:"Đồng Tháp"},{id:59,name:"Gia Lai"},{id:219,name:"Hà Giang"},{id:351,name:"Hà Nam"},{id:43,name:"Hà Tây"},{id:39,name:"Hà Tĩnh"},{id:320,name:"Hải Dương"},{id:31,name:"Hải Phòng"},{id:711,name:"Hậu Giang"},{id:218,name:"Hòa Bình"},{id:321,name:"Hưng Yên"},{id:58,name:"Khánh Hòa"},{id:77,name:"Kiên Giang"},{id:60,name:"Kon Tum"},{id:231,name:"Lai Châu"},{id:25,name:"Lâm Đồng"},{id:20,name:"Lạng Sơn"},{id:63,name:"Lào Cai"},{id:72,name:"Long An"},{id:350,name:"Nam Định"},{id:38,name:"Nghệ An"},{id:30,name:"Ninh Bình"},{id:68,name:"Ninh Thuận"},{id:210,name:"Phú Thọ"},{id:57,name:"Phú Yên"},{id:52,name:"Quảng Bình"},{id:510,name:"Quảng Nam"},{id:55,name:"Quảng Ngãi"},{id:33,name:"Quảng Ninh"},{id:53,name:"Quảng Trị"},{id:79,name:"Sóc Trăng"},{id:22,name:"Sơn La"},{id:66,name:"Tây Ninh"},{id:36,name:"Thái Bình"},{id:280,name:"Thái Nguyên"},{id:282,name:"Thanh Hóa"},{id:37,name:"Thanh Hóa"},{id:54,name:"Thừa Thiên Huế"},{id:73,name:"Tiền Giang"},{id:74,name:"Trà Vinh"},{id:27,name:"Tuyên Quang"},{id:70,name:"Vĩnh Long"},{id:211,name:"Vĩnh Phúc"},{id:29,name:"Yên Bái"}],U()):K()},L=function(){w.on("click",()=>{$(".tnc__section").removeClass("active"),$("#condition-section").addClass("active")}),H.on("click",()=>{$(".tnc__section").removeClass("active"),$("#security-section").addClass("active")})},Q=function(n,e){switch(n){case r:TweenMax.killTweensOf(d),TweenMax.to(d,.3,{alpha:1,ease:Sine.easeOut}),d.html(e);break;case l:TweenMax.killTweensOf(loginError),TweenMax.to(loginError,.3,{alpha:1,ease:Sine.easeOut}),loginError.html(e)}clearTimeout(h),h=setTimeout(O,5e3,n)},O=function(n){switch(n){case r:TweenMax.killTweensOf(d),TweenMax.to(d,.3,{alpha:0,ease:Sine.easeOut});break;case l:TweenMax.killTweensOf(loginError),TweenMax.to(loginError,.3,{alpha:0,ease:Sine.easeOut})}},C=function(){if(A(),D())if(p.prop("checked"))if(isLocal)P(c);else{const n=baseUrl+"profile";$.ajax({headers:{Authorization:"Bearer "+window.localStorage.getItem("token")},type:"POST",contentType:"application/json",data:JSON.stringify(f),url:n,success:P,error:V})}else Q(r,"Bạn chưa đồng ý với điều khoản và thể lệ chương trình!")},P=function(n){"Update success"===n.message&&(window.localStorage.setItem("profile",!0),G(),E())},G=function(){s.css({position:"absolute",left:"-100%",top:"-100%",opacity:0,visibility:"hidden"})},E=function(){b.css({display:"block"})},V=function(n){const e=n.responseJSON;e.message?Q(r,e.message):Q(r,"Không thể đăng ký, vui lòng kiểm tra lại thông tin!")},A=function(){0!=a&&(f.province_id=a),0!=o&&(f.district_id=o),Object.keys(g).forEach(n=>{const e=$("#"+g[n]).val();f[n]=e}),W(a,nn)},D=function(){const n=[];for(let e=0;e<u.length;e++){const i=u[e];if(null===f[i]||void 0===f[i]||""===f[i]){const e=T[i];if(!n.includes(i))return Q(r,e),!1}}return!0},K=function(){const n=baseUrl+"province";$.ajax({type:"GET",url:n,success:j,error:z})},j=function(i){n=i,console.log(n),n.map((n,i)=>{282!=n.id&&e.push(n)}),n=e,U()},z=function(n){const e=n.responseJSON;e.message?d.html(e.message):d.html("Please try again later!")},U=function(){const e=n.map(n=>n.name);new DropDownBox("dropdown-work-city",{itemArray:e,itemHeight:40},"Tỉnh/Thành Phố",F);k.on("click",Y),v.on("click",X),q()},X=function(){Number(window.localStorage.getItem("gameLeft"))>0?(G(),b.css({display:"none"}),setTimeout(R,100),S.css("display","none")):J()},J=function(){TweenMax.killTweensOf(M),TweenMax.to(M,.3,{autoAlpha:1,ease:Sine.easeOut}),$("#congrate-button-text").text("OK"),N.text("Bạn đã hết lượt chơi."),M.text("Hẹn gặp bạn ở chương trình sau!"),$("#congrate-button-text").on("click",()=>{window.scrollTo(0,0)}),clearTimeout(void 0)},Y=function(){I()},q=function(){y.css({display:"block"}),B.css({opacity:0,visibility:"hidden"})},I=function(){y.css({display:"none"}),B.css({opacity:1,visibility:"visible"})},R=function(){x.css({position:"relative",opacity:1,visibility:"visible"}),window.dispatchEvent(StartGameEvent);const n=$(document).height()-$("#quiz-section").height()-100;$(window).scrollTop(n)},F=function(e){a=n.find(n=>n.name===e).id,o=0,isLocal?nn(t):W(a,nn)},W=function(n,e){const i=baseUrl+"province/"+n;$.ajax({type:"GET",url:i,success:e,error:Z})},Z=function(n){const e=n.responseJSON;e.message?d.html(e.message):d.html("Please try again later!")},nn=function(n){i=n;const e={itemArray:n.map(n=>n.name),itemHeight:40};new DropDownBox("dropdown-work-dist",e,"Quận/Huyện",en)},en=function(n){o=i.find(e=>e.name===n).id},an=function(){window.dropdownMap&&window.dropdownMap.size>0&&window.dropdownMap.forEach(n=>n.collapse())};window.addEventListener("click",an),_()});