$(function(){let e,t,n,a=[{question:"Thuốc súc miệng họng Medoral của MERAPGroup là sản phẩm điều trị & dự phòng các loại bệnh nào?",answer:["A. Dung dịch vệ sinh phụ nữ","B. Viêm họng, viêm lợi, loét miệng","C. Mắt mỏi/Mắt khô"],correct:"B"},{question:"Xưa hay vô thức lấy tay chùi mặt, nay tránh COVID-19 thì tay làm gì?",answer:["A. Nắm tay cầu nguyện","B. Đưa tay lên mắt, mũi, miệng","C. Rửa tay xà phòng thường xuyên"],correct:"C"},{question:"Hoạt chất Chlorhexidin trong thuốc súc miệng họng Medoral MERAPGroup có tác dụng gì?",answer:["A. Diệt vi rút, vi khuẩn, nấm","B. Trị đau bao tử","C. Làm trắng và chắc răng"],correct:"A"},{question:"Cách sử dụng thuốc súc miệng họng Medoral của MERAPGroup?",answer:["A. Súc họng","B. Súc miệng","C. Cả A & B"],correct:"C"},{question:"Trước gặp nhau tay bắt mặt mừng, nay trong giai đoạn COVID-19 gặp nhau làm gì?",answer:["A. Làm thinh","B. Ôm hôn thắm thiết","C. Không vồ vập, không bắt tay"],correct:"C"},{question:"Các triệu chứng bạn sẽ tư vấn Dung dịch nhỏ mắt dưỡng ẩm tự nhiên Osla Online của MERAPGroup cho người mua thuốc?",answer:["A. Mắt sưng","B. Mắt nhắm","C. Khô mắt, chảy nước mắt, mắt nhìn mờ/nhòe"],correct:"C"},{question:"Sản phẩm dung dịch nhỏ mắt dưỡng ẩm tự nhiên của MERAPGroup tên là gì?",answer:["A. Osla Redi","B. Osla Online","C. Osla Cool"],correct:"B"},{question:"Trong giai đoạn dịch COVID-19, người luôn quan tâm, nhắn tin dặn dò giữ gìn sức khoẻ là ai?",answer:["A. Bộ Y Tế","B. Người ngoài","C. Người yêu cũ"],correct:"A"},{question:"Tên thành phần hoạt chất thế hệ mới trong dung dịch nhỏ mắt dưỡng ẩm tự nhiên Osla Online?",answer:["A. Clobetason Butyrat","B. Hyaluronate Sodium","C. Glycerol"],correct:"B"}],o={message:"SUBMIT_SUCCESS",game_left:1},i=$("#registration-profile"),s=$("#quiz-section"),c=$(".chat__holder"),l=$("#quiz-welcome-name"),u=$("#quiz-welcome-number"),r=$("#quiz-ques"),h=$("#quiz-a"),g=$("#quiz-b"),m=$("#quiz-c"),w=[],p=$("#res-holder"),d=$("#user-res"),T=$("#answer-holder"),f=$("#answer-input"),M=$("#quiz-button"),x=0,A=[],C={text:{}},y=$("#congrate-holder"),O=$("#answer-error"),S=$("#quiz-result"),v=$("#quiz-result-content"),q=function(){for(let e=0;e<c.length;e++){const t=c[e];TweenMax.set(t,{autoAlpha:0})}TweenMax.set(p,{autoAlpha:0}),M.on("click",_)},b=function(){for(let e=0;e<c.length;e++){const t=c[e],n=1+e/.7;TweenMax.killTweensOf(t),TweenMax.to(t,.5,{autoAlpha:0,ease:Sine.easeOut,delay:n/10})}const e=(1+(c.length-1)/.7)/10;TweenMax.to(p,.5,{autoAlpha:0,ease:Sine.easeOut,delay:e,onComplete:()=>{TweenMax.killTweensOf(T),TweenMax.to(T,.2,{autoAlpha:0,ease:Sine.easeOut,onComplete:B})}})},B=function(){if(x>=3)k();else{const e=window.localStorage.getItem("username"),t=A[x];l.text(e),u.text(x+1),r.text(t.question),w.forEach((e,n)=>{e.text(t.answer[n])}),function(){for(let e=0;e<c.length;e++){const t=c[e],n=1+e/.7;TweenMax.killTweensOf(t),TweenMax.to(t,.5,{autoAlpha:1,ease:Sine.easeOut,delay:n}),TweenMax.from(t,.5,{y:50,ease:Quint.easeOut,delay:n})}TweenMax.killTweensOf(T),TweenMax.to(T,.2,{autoAlpha:1,ease:Sine.easeOut,delay:1+(c.length-1)/.7})}()}},k=function(){if(isLocal)z(o);else{const e=baseUrl+"game";$.ajax({headers:{Authorization:"Bearer "+window.localStorage.getItem("token")},type:"POST",contentType:"application/json",data:JSON.stringify(C),url:e,success:z,error:E})}},z=function(e){if("SUBMIT_SUCCESS"===e.message){const t=e.game_left,a="true"===window.localStorage.getItem("profile");U(t),I(),clearTimeout(n),n=setTimeout(()=>{TweenMax.killTweensOf(S),TweenMax.to(S,.3,{autoAlpha:0,ease:Sine.easeOut}),R(),a?L():G()},3e3)}},E=function(e){},I=function(){s.css({height:300});const e=window.localStorage.getItem("username");let t=0;const n=C.text;Object.values(n).map(e=>{e.userAnswer.toLowerCase()===e.correct.toLowerCase()&&(t+=1)});let a="";t<=2&&(a="Rất tiếc "+e+", bạn chỉ đúng được "+(t+"/3")+" câu. Cố gắng ở những lượt chơi tiếp theo bạn nhé!"),3===t&&(a="Chúc mừng "+e+", bạn trả lời đúng cả 3 câu."),v.text(a),TweenMax.to(S,.3,{autoAlpha:1,ease:Sine.easeOut})},R=function(){s.css({position:"absolute",top:0,left:0,opacity:0,visibility:"hidden",height:"auto"})},G=function(){i.css({display:"block",position:"relative",top:0,left:0,opacity:1,visibility:"visible"})},L=function(){y.css({display:"block"})},_=function(){!function(){const e=f.val(),t=e.match(/[A-Ca-c]/g);return""!==e&&" "!==e&&t&&1===e.length}()?D():(C.text[x]=A[x],C.text[x].userAnswer=f.val(),d.text(f.val()),TweenMax.to(p,.5,{autoAlpha:1,ease:Sine.easeOut}),f.val(""),x+=1,clearTimeout(e),e=setTimeout(b,1e3))},D=function(){TweenMax.killTweensOf(O),O.text("Bạn vui lòng đọc hướng dẫn và soạn đúng cú pháp nhé!"),TweenMax.to(O,.3,{autoAlpha:1,ease:Sine.easeOut,onComplete:()=>{clearTimeout(t),t=setTimeout(P,5e3)}})},P=function(){TweenMax.to(O,.3,{autoAlpha:0,ease:Sine.easeOut})},U=function(e){window.localStorage.setItem("gameLeft",e)};w=[h,g,m],q(),window.addEventListener(MerapCustomEvent.START_GAME,()=>{x=0;const e=Math.round(Math.random()*(a.length-3));A=Math.random()>.5?a.slice(e,e+3):a.slice(e,e+3).reverse(),C={text:{}},B()})});