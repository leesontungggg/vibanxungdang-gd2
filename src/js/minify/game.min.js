$(function(){let e,t,n,a=[{question:"Thuốc súc miệng họng Medoral của MERAPGroup là sản phẩm điều trị & dự phòng các loại bệnh nào?",answer:["A. Dung dịch vệ sinh phụ nữ","B. Viêm họng, viêm lợi, loét miệng","C. Mắt mỏi/Mắt khô"],correct:"B"},{question:"Xưa hay vô thức lấy tay chùi mặt, nay tránh COVID-19 thì tay làm gì?",answer:["A. Nắm tay cầu nguyện","B. Đưa tay lên mắt, mũi, miệng","C. Rửa tay xà phòng thường xuyên"],correct:"C"},{question:"Các triệu chứng bạn sẽ tư vấn Dung dịch nhỏ mắt dưỡng ẩm tự nhiên Osla Online của MERAPGroup cho người mua thuốc?",answer:["A. Mắt sưng","B. Mắt nhắm","C. Khô mắt, chảy nước mắt, mắt nhìn mờ/nhòe"],correct:"C"},{question:"Cách sử dụng thuốc súc miệng họng Medoral của MERAPGroup?",answer:["A. Súc họng","B. Súc miệng","C. Cả A & B"],correct:"C"},{question:"Trước gặp nhau tay bắt mặt mừng, nay trong giai đoạn COVID-19 gặp nhau làm gì?",answer:["A. Làm thinh","B. Ôm hôn thắm thiết","C. Không vồ vập, không bắt tay"],correct:"C"},{question:"Sản phẩm dung dịch nhỏ mắt dưỡng ẩm tự nhiên của MERAPGroup tên là gì?",answer:["A. Osla Redi","B. Osla Online","C. Osla Cool"],correct:"B"},{question:"Hoạt chất Chlorhexidin trong thuốc súc miệng họng Medoral MERAPGroup có tác dụng gì?",answer:["A. Diệt vi rút, vi khuẩn, nấm","B. Trị đau bao tử","C. Làm trắng và chắc răng"],correct:"A"},{question:"Trong giai đoạn dịch COVID-19, người luôn quan tâm, nhắn tin dặn dò giữ gìn sức khoẻ là ai?",answer:["A. Bộ Y Tế","B. Người ngoài","C. Người yêu cũ"],correct:"A"},{question:"Tên thành phần hoạt chất thế hệ mới trong dung dịch nhỏ mắt dưỡng ẩm tự nhiên Osla Online?",answer:["A. Clobetason Butyrat","B. Hyaluronate Sodium","C. Glycerol"],correct:"B"}],o={message:"SUBMIT_SUCCESS",game_left:1},i=$("#registration-profile"),s=$("#quiz-section"),l=$(".chat__holder"),c=($(".result-feedback"),$("#chat_hello")),u=$("#quiz-welcome-name"),r=$("#quiz-welcome-number"),h=$("#quiz-ques"),g=$("#quiz-a"),m=$("#quiz-b"),w=$("#quiz-c"),d=[],p=$("#res-holder"),T=$("#user-res"),f=$("#answer-holder"),y=$("#answer-input"),M=$("#quiz-button"),x=0,A=[],C={text:{}},O=$("#congrate-holder"),S=$("#answer-error"),q=$("#quiz-result"),b=$("#quiz-result-thankyou-1"),v=$("#quiz-result-thankyou-2"),B=$("#quiz-result-content"),k=$("#quiz-result-feedback"),z=function(){for(let e=0;e<l.length;e++){const t=l[e];TweenMax.set(t,{autoAlpha:0})}TweenMax.set(p,{autoAlpha:0}),M.on("click",U)},I=function(){for(let e=0;e<l.length;e++){const t=l[e],n=1+e/.7;TweenMax.killTweensOf(t),TweenMax.to(t,.5,{autoAlpha:0,ease:Sine.easeOut,delay:n/10})}const e=(1+(l.length-1)/.7)/10;TweenMax.to(p,.5,{autoAlpha:0,ease:Sine.easeOut,delay:e,onComplete:()=>{TweenMax.killTweensOf(f),TweenMax.to(f,.2,{autoAlpha:0,ease:Sine.easeOut,onComplete:E})}}),document.getElementById("quiz-section").scrollIntoView()},E=function(){if(x>=3)L();else{0==x?c.css("display","block"):c.css("display","none");const e=window.localStorage.getItem("username"),t=A[x];u.text(e),r.text(x+1),h.text(t.question),d.forEach((e,n)=>{e.text(t.answer[n])}),function(){for(let e=0;e<l.length;e++){const t=l[e],n=1+e/.7;TweenMax.killTweensOf(t),TweenMax.to(t,.5,{autoAlpha:1,ease:Sine.easeOut,delay:n}),TweenMax.from(t,.5,{y:0,ease:Quint.easeOut,delay:n})}TweenMax.killTweensOf(f),TweenMax.to(f,.2,{autoAlpha:1,ease:Sine.easeOut,delay:1+(l.length-1)/.7})}()}},L=function(){if(isLocal)R(o);else{const e=baseUrl+"game";$.ajax({headers:{Authorization:"Bearer "+window.localStorage.getItem("token")},type:"POST",contentType:"application/json",data:JSON.stringify(C),url:e,success:R,error:_})}},R=function(e){if("SUBMIT_SUCCESS"===e.message){const t=e.game_left,a="true"===window.localStorage.getItem("profile");H(t),G(),clearTimeout(n),n=setTimeout(()=>{TweenMax.killTweensOf(q),TweenMax.to(q,.3,{autoAlpha:0,ease:Sine.easeOut}),D(),a?N():P()},15e3)}},_=function(e){},G=function(){s.css({height:700});const e=window.localStorage.getItem("username");let t=0;const n=C.text;Object.values(n).map(e=>{e.userAnswer.toLowerCase()===e.correct.toLowerCase()&&(t+=1)});const a=t+"/3";let o="";const i=Number(window.localStorage.getItem("gameLeft"));t<=2&&(o="Bạn đã trả lời đúng "+a+" câu hỏi. Bạn còn "+i+"/3 lượt chơi."),3===t&&(o="Chúc mừng "+e+", bạn trả lời đúng cả 3 câu. Bạn còn "+i+"/3 lượt chơi."),B.text(o),TweenMax.to(k,.3,{autoAlpha:1,ease:Sine.easeOut,display:"block"}),TweenMax.to(q,.3,{autoAlpha:1,ease:Sine.easeOut}),TweenMax.to(b,.3,{autoAlpha:1,ease:Sine.easeOut,delay:1}),TweenMax.to(v,.3,{autoAlpha:1,ease:Sine.easeOut,delay:4})},D=function(){s.css({position:"absolute",top:0,left:0,opacity:0,visibility:"hidden",height:"auto"})},P=function(){i.css({display:"block",position:"relative",top:0,left:0,opacity:1,visibility:"visible"})},N=function(){O.css({display:"block"})},U=function(){!function(){const e=y.val(),t=e.match(/[A-Ca-c]/g);return""!==e&&" "!==e&&t&&1===e.length}()?V():(C.text[x]=A[x],C.text[x].userAnswer=y.val(),T.text(y.val()),TweenMax.to(p,.5,{autoAlpha:1,ease:Sine.easeOut}),y.val(""),x+=1,clearTimeout(e),e=setTimeout(I,1e3))},V=function(){TweenMax.killTweensOf(S),S.text("Bạn vui lòng đọc hướng dẫn và soạn đúng cú pháp nhé!"),TweenMax.to(S,.3,{autoAlpha:1,ease:Sine.easeOut,onComplete:()=>{clearTimeout(t),t=setTimeout(j,5e3)}})},j=function(){TweenMax.to(S,.3,{autoAlpha:0,ease:Sine.easeOut})},H=function(e){window.localStorage.setItem("gameLeft",e)};d=[g,m,w],z(),window.addEventListener(MerapCustomEvent.START_GAME,()=>{x=0;const e=Math.round(Math.random()*(a.length-3));Math.random()>.5?(A=a.slice(e,e+3),a.splice(e,3)):(A=a.slice(e,e+3).reverse(),a.splice(e,3)),C={text:{}},A[0].question="Câu hỏi 1: "+A[0].question,A[1].question="Câu hỏi 2: "+A[1].question,A[2].question="Câu hỏi 3: "+A[2].question,E()})});